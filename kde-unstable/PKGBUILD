# $Id$
# Maintainer: Felix Yan <felixonmars@archlinux.org>
# Maintainer: Antonio Rojas <arojas@archlinux.org>
# Contributor: Andrea Scarpino <andrea@archlinux.org>
# Contributor: Pierre Schmitz <pierre@archlinux.de>

pkgbase=kde-l10n
pkgver=17.03.80
pkgrel=1
arch=('any')
url='https://www.kde.org/'
license=('GPL')
depends=('qt5-translations') # needed for RTL languages FS#50780
makedepends=('extra-cmake-modules' 'kdoctools' 'kdelibs' 'automoc4' 'kconfig' 'ki18n' 'qt5-tools' 'python')
options=('docs')

_languages=(
  'ar     "Arabic"'
  'ast    "Asturian"'
  'bg     "Bulgarian"'
  'bs     "Bosnian"'
  'ca     "Catalan"'
  'ca@valencia     "Catalan (Valencian)"'
  'cs     "Czech"'
  'da     "Danish"'
  'de     "German"'
  'el     "Greek"'
  'en_GB  "British English"'
  'eo     "Esperanto"'
  'es     "Spanish"'
  'et     "Estonian"'
  'eu     "Basque"'
  'fa     "Farsi"'
  'fi     "Finnish"'
  'fr     "French"'
  'ga     "Irish"'
  'gl     "Galician"'
  'he     "Hebrew"'
  'hi     "Hindi"'
  'hr     "Croatian"'
  'hu     "Hungarian"'
  'ia     "Interlingua"'
  'id     "Indonesian"'
  'is     "Icelandic"'
  'it     "Italian"'
  'ja     "Japanese"'
  'kk     "Kazakh"'
  'km     "Khmer"'
  'ko     "Korean"'
  'lt     "Lithuanian"'
  'lv     "Latvian"'
  'mr     "Marathi"'
  'nb     "Norwegian Bokmal"'
  'nds    "Low Saxon"'
  'nl     "Dutch"'
  'nn     "Norwegian Nynorsk"'
  'pa     "Panjabi/Punjabi"'
  'pl     "Polish"'
  'pt     "Portuguese"'
  'pt_BR  "Brazilian Portuguese"'
  'ro     "Romanian"'
  'ru     "Russian"'
  'sk     "Slovak"'
  'sl     "Slovenian"'
  'sr     "Serbian"'
  'sv     "Swedish"'
  'tr     "Turkish"'
  'ug     "Uyghur"'
  'uk     "Ukrainian"'
  'wa     "Walloon"'
  'zh_CN  "Chinese Simplified"'
  'zh_TW  "Chinese Traditional"'
)

pkgname=()
source=()

for _lang in "${_languages[@]}"; do
  _locale=${_lang%% *}
  _pkgname=kde-l10n-${_locale,,}
  
  pkgname+=($_pkgname)
  source+=("https://download.kde.org/unstable/applications/$pkgver/src/$pkgbase/$pkgbase-$_locale-$pkgver.tar.xz")
  eval "package_$_pkgname() {
    _package $_lang
  }"
done

sha256sums=('74ec464ffb5e879058f402866d813759317d64c4e659ddece7950315ea23d26c'
            '67214b5a97c3ea13f607c329e979d028cd5332f52565f084f77a26ad42a35c29'
            'cc537b8d44691e73af2872af4bcb5e9a58d3bfda73b14a984c6351b0c5854271'
            '959a8c0cd218b7c7fffb6a7e69945ee5bec70d1dab19d1fe750226c28507a0eb'
            '9b694ac8842b2d202bbe09f7016e281526e7a88aa703f8ed6ab931741c3fee25'
            '6f0d5410253cdf7bf12c5b86aae728bdb158259279856d6fef28f318de3db199'
            '93cd693f8052b643a3522a6008a0da6a68b76edf50d4d26c1a19bad67ddfcfd0'
            '59667508bd5cf38c0d976e6fe57c61ed406488da8add9fa5a6145becba39570a'
            'a8c47bc084cffe8504a54f96d756ef87230d1317da23c522ea5586f9724a8191'
            '80149d182c67db6f5e7f62e0bf8ddba07873736fbc896e04f6b736b8586da5de'
            '0b3ed9ed8da240514397957b53f4c8fcdf0ce80977b40cb4d5acdab7d14940e3'
            'a7a03369f517c06dbdf92c6d7fc7503c3750726634a1f469ed0c380e321f1c5d'
            'b36ee04996016021e772b062f76aa17d71cd6ce3c46f8a1e7f1d96b47feb3c40'
            '0ba4b0eb60cb1cdb3fdc9d676c21d99d28c21bed6bd5c8312bc03e455ba89194'
            '2daa4e83fc6f7b8b87968ea9e74fa52d59447a81ba1b8d2be22bd241b59df678'
            '51d60c47d0bb8e1c79540ecf73b6d4642f2a4e8c828ed96232a90dec5986be21'
            'c7ff525065e991693f93c68575f3408351fec4135b7a320e6f7bf7d12393ef9f'
            'f9f97a44a0481c3e3a204c809b8384ca1ea95a84f13b4948647c0d21c1a967c2'
            '0dc4f83d90b69f65b1dd839938cb152589efc0db4cec583928d63c0ec37d311a'
            '0eb2443ed9d7e3c51e6260c284ed209ada1a13a9fe9bb9dd9abfeb2f25ee93e5'
            'd1150a342422372bcfd7d95f4b342091125d41de004cf4703918abbda0593c2c'
            '00cae54207089f08509f2350cb1868fad2984fc8c2df7d7a142ee47e64fe6e59'
            'a1dccd4a3b544912daaf5944ee79c1bbaa65c58eb535a25067d328b3cb66e09d'
            '53ad2cb9ec642239e9a4abeaec18796cd76fd39aaa3f13ac90d022389cb250ed'
            '079e3141b1e8511b66ae5c5ef78aa3b7d51eea771148402c494553b41ef6667c'
            '209c2bcc9133bce92d875b9b375f8d6c86f4e670f0db95adb1c01782a7c9f343'
            '5dac084f32e87c6db480f208d2bba6ab9f7713bdeba8b77d734e81b6e76fdb9c'
            '2fd4034422d8295c0ec94301212b5cfb023bb34df6838a4d17c520f0d274ba3e'
            '6839c61d36015ecde5199ae14ae03ec2068b1bce246dca070c1ac563657997fc'
            'b4090306f00bb1d0b56c119743073e93b7f9c6cba2ebb15604c75a221324187e'
            'd118f9c5af6b54e7fdc3686ffe89b668a5473068ced8db457d9e368a67dcb494'
            'd0a3aad5fdf754beab59ae4fb640ad72dab8086f9bbd08bd9fe3e08a51a476de'
            'ca715b9fcd88294dee7959f79638681e3e3e0aa1f411c5ce0fefb5955ac8d62a'
            '6ea564a5af749a79ce29a8d97724030dba8baf9a0c8a16a329f2a564a62a9eda'
            'f6e4d00f6ee53b64cdf70b63ab1515e39c0f4137d5401d39f7900c8351b2fefc'
            '766a9dc0ec5840e651e0f7c4e0f5644360a697ab9b1a1c94b279a736c0b2be14'
            '7dd3a565623d67e364f8955e39d075f20620509191eb370bff02c1a67b251b09'
            'f445a7fd887b882b4231fcea90eef88677532ebbbf37afcf96c090c168991293'
            '2ef7c0912a68b02eb05ab46ddca863dc4b394006843fb9f3365780a7942520d8'
            '10e143ed9f155de3fc797e4e5e2da598ca390533721af6632ad4e1ad36cd84d6'
            '347fbfb4a6f97ba875da255220089ef8b7b2ea0b895e935a20fda9593b5a6a8b'
            '5085edb8b0410b51684395a04f09586b94a936ff477b4fcbf21536c0609294e1'
            '7c12285c35f1ba1b5aa70f3b81a3a07c27d7f48c3b2a8af8a95cafe7c06bf00c'
            'f35ad04e219552c15516036507fe0c513af324ffb0f621864d64f41ec12a4657'
            '9ceb5d2250f8cc776cfb122aea25115a4e9c56393608002fcc3ff6fab64844d2'
            '9052d983961f2793e98a27a016ad6f6a55bb74e7f2e1fec4e5816a55002b6792'
            'f000ce3e8a1735bd0be29611aa8150af7cec422029497c4a2a00032cca529a39'
            '81f05e94f45cc2ae0adcd412829be7be49f2380c93d4cb1ca48d414cc25c602e'
            'dd3949ce3a9dbf891d3c571f0b6d39533145aea753ee0cee61c2051fe5e78418'
            '8aa08e5a9a4d2ade2b387e831e8258f1963de1b61c3a652703d0dc8e92838a4f'
            'b16c745218318fcee58912361ca3359da20f4f85e89b89c88e9d16b64fb46f31'
            'f1dd6b88ada3e92923b1e5aed33f2259d485cce45ae8eb2f3bb650bd7c01956f'
            'c5c84733755e8dbcc19d05bafdd2f6c238a566eb8dd936fb49b28efe1464149d'
            'a3bb3b558fecb11066d8c0d7ca2af56610cd0cbebffb8b2fb9fa3bfb08c1e086'
            '709e2801c0fff163bced237d64292ca942127b8c06af989233855cc31d59f195')

build() {
  for _lang in "${_languages[@]}"; do
    _locale=${_lang%% *}
    
    mkdir -p build/$_locale
    cd build/$_locale
    cmake $srcdir/$pkgbase-$_locale-$pkgver \
      -DCMAKE_BUILD_TYPE=Release \
      -DCMAKE_INSTALL_PREFIX=/usr
    make
    cd ../..
  done
}

_package() {
  pkgdesc="$2 localization for KDE Applications"
  cd build/$1
  make DESTDIR="$pkgdir" install

# Fix conflicts
  rm -fr "$pkgdir"/usr/share/doc/HTML/*/{kdesu,knetattach,kcontrol/kcm_ssl}
}
