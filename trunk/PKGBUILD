# $Id$
# Maintainer: Felix Yan <felixonmars@archlinux.org>
# Maintainer: Antonio Rojas <arojas@archlinux.org>
# Contributor: Andrea Scarpino <andrea@archlinux.org>
# Contributor: Pierre Schmitz <pierre@archlinux.de>

pkgbase=kde-l10n
pkgver=17.04.1
pkgrel=1
arch=(any)
url='https://www.kde.org/'
license=(GPL)
makedepends=(kdelibs cmake automoc4)
options=(docs)

_languages=(
  'ar     "Arabic"'
  'ast    "Asturian"'
  'bg     "Bulgarian"'
  'bs     "Bosnian"'
  'ca     "Catalan"'
  'ca@valencia     "Catalan (Valencian)"'
  'cs     "Czech"'
  'da     "Danish"'
  'de     "German"'
  'el     "Greek"'
  'en_GB  "British English"'
  'eo     "Esperanto"'
  'es     "Spanish"'
  'et     "Estonian"'
  'eu     "Basque"'
  'fa     "Farsi"'
  'fi     "Finnish"'
  'fr     "French"'
  'ga     "Irish"'
  'gl     "Galician"'
  'he     "Hebrew"'
  'hi     "Hindi"'
  'hr     "Croatian"'
  'hu     "Hungarian"'
  'ia     "Interlingua"'
  'id     "Indonesian"'
  'is     "Icelandic"'
  'it     "Italian"'
  'ja     "Japanese"'
  'kk     "Kazakh"'
  'km     "Khmer"'
  'ko     "Korean"'
  'lt     "Lithuanian"'
  'lv     "Latvian"'
  'mr     "Marathi"'
  'nb     "Norwegian Bokmal"'
  'nds    "Low Saxon"'
  'nl     "Dutch"'
  'nn     "Norwegian Nynorsk"'
  'pa     "Panjabi/Punjabi"'
  'pl     "Polish"'
  'pt     "Portuguese"'
  'pt_BR  "Brazilian Portuguese"'
  'ro     "Romanian"'
  'ru     "Russian"'
  'sk     "Slovak"'
  'sl     "Slovenian"'
  'sr     "Serbian"'
  'sv     "Swedish"'
  'tr     "Turkish"'
  'ug     "Uyghur"'
  'uk     "Ukrainian"'
  'wa     "Walloon"'
  'zh_CN  "Chinese Simplified"'
  'zh_TW  "Chinese Traditional"'
)

pkgname=()
source=()

for _lang in "${_languages[@]}"; do
  _locale=${_lang%% *}
  _pkgname=kde-l10n-${_locale,,}
  
  pkgname+=($_pkgname)
  source+=("https://download.kde.org/stable/applications/$pkgver/src/$pkgbase/$pkgbase-$_locale-$pkgver.tar.xz")
  eval "package_$_pkgname() {
    _package $_lang
  }"
done

sha256sums=('7bbcd32164fc1c9e553c9c11f31092aeea8e9b27d52ede386f861c84b6d67ba8'
            '14f3d6502c8fe2fe3102df81123e85436b639f17670f8d1925fa38be8cc89d19'
            '893ddd50f94efbe79db592923606785da3b66c546b703e7bbd5bc1b61230a191'
            '210088507785d3a6606d5b1fe20cf95e7897c98ba01bf61adbe55455de1d4091'
            '12fce2ea402a25e1f4205399be68241e235e9461c8e33b05a0c74f3dc7bf239b'
            '8ee61d32450ec20004c87f317d37af1e254baaf487076ca0c177fe102fefd912'
            'acc4ae135e3bae247b03a8bacc4b3fefcdce387baa0e4cad8f14969b28c470da'
            'b5bae6e47a369f741d60163e78bf7a5b9f89dad7ee9b07e80fdff3d1d0f266f1'
            '15a5108c9c9a3d36780fe0ad9c3af16db5e908c4214133015251d30cfcf4b35b'
            '4df7158b1a3568956611f8b0ef1c8edb086c5a634df9ead8e7fccb8aee5b7a93'
            '7fb1136d2c684ce619bba9e47eb882acf9e4af33c49c9833b26e5121fcc70722'
            '65c6231aa7d2faa64d0dde93d4625af0651997913c31f5918955480f323e88bc'
            'a7bcf1a6b94f9382cb50281411129a9f1f6547d3863a43b5d42ca2ea694ddd03'
            '3baac031d1ee1bb9adc32451be30ef47c56dedf42b4dbd7b7c5112b1341cb17c'
            'd39683729c35be4d7a5ec0d38503dbc15d17d6a20877cf37caa785fdf8246001'
            '3933f7f0696cca459a6e4f658bce48977f8c8762cece197acd850e65c1901a1a'
            'e1574734025314d1dc2c87d6930ea6acbdffee30d47c7fca39f9bdcfc580bfcb'
            '468015a1a0195b9eaeee0e9f1ac782f8458145a9d0153d74ca1a1d263b97b973'
            '9cf35dad9289e47df9558ace6b88afd4b4cc7ecdc6cebcab776b05839040f793'
            'ede51207e6fa0f149a22fd907b000f67e1618131423abcbd44d794d40d9fe6dc'
            '9681dda9c6b53156f618c055ed44703569860c51fa19e8e9eb3530c3e198e8ea'
            '90a9ea1ebdaeb3445b9c6bcddd34efa06afc6bc701f43144ae090cfd968eab85'
            'fe43b9e48a138e0598fc2cdd7ccc5a66c54e1a11a59b45a3be8d10de28963fc6'
            '4b740d81b708ee56f536a315310ea94526ddf9f69ebb6795601d6e7130ba6329'
            'c344d4f2f714361bbab2d1c52d6ed75239cc905c5de20589221d23711edc41eb'
            '9de258fd75aee4f5991537e768d723b458aeebbff722c54593435476516e609f'
            '685f1d413a37408a2c26cc333bf47cd23e472bfa9c4c3ba3478197f2c5d51321'
            '523b73531ebf2928f1d694ce05db7fc142fd67b08ca6dc149fe08734da338b18'
            '4f0df9d222ade32b89bd9f5d1b763c89db9b8c6092788a1e912141949302be04'
            'bf21476a0b5058d626a702cef9901a8dc64dc8d3505b56dbcd2b96be03d0f524'
            'c34b3263e6ebb158f18f819e18ece53e5f836dc5ad4f16abd2ab42a69335a407'
            'af362af1016b05c70e0bffe913c29e658daf8dfea6022d7b45ae6e9ab585cad9'
            '09c7643fe110627473262d2ef8ca7c17d4f49b9bd24757cbeee7407d41efb60c'
            '821fea5332cc6ec9ad4ba25792481efe211f08f4a5142fb8fe13f70455da0a94'
            '248b88e4b458a575f2dd846c0a06227dfa3bf6ffa2778304670107cd6f77ec9f'
            '835289e5eefab7eb9c4b982d12c88f523dd0b57612c8a6f99ef1ab28c434ecb1'
            '1a822a792467eddc084ef736421f365357ce6fc79f0f8f7782489cf96788944c'
            '513bcb76e2f9ee1c8bdacbe37b88008bbec8f9e27f8ed8f36e851747c1787c3d'
            '989c4d916a1d43dbf469c6eb8a9398413466a4a4898f96f892729db808a89099'
            'd887d831a9150b1b1501bdc1a06d8bcef4b5c924f90baa1ee1618b2cc5d7e1c1'
            '27bfe116bd5a4f3fbe1f5887d0c3d493fd608f87f633031c5e8233dbd4e47648'
            'f480638c68936b39d2a783d9b4caa5497e84fb0126d0bd59bc01d3e25be574a0'
            '5cb56cd90ae98c926f0af93a4c8e5a9e75927cf0825bcc51ed32795a46868669'
            'e71df3af002ef71bc736dba6ac11c4c983c184e3737aec51a356856eea9b286d'
            'ccf5ee4eb9b9d0158b6388e957de92dbc9d4d5f486163189ba87fc0d8a7c8d05'
            '903a7f51606af43e05429697514a777e825d923fa44ea5454ae387d591cc09cb'
            '2367101237ee2e69b5aa73abd6c3ef78c74e331fa3b89ddb6cc9eee43428f27e'
            '28ea0e28e374b7c4bba85fb3e530566f223016d65e9b9df70895cc143c3ed1e4'
            '044afc38b3869151aef8e5228c6eb7a4c8c01522ecb9a4f396634a7621931732'
            '460a9f0d1097c8e52554aed83e5f5fdb00506ab9f3df6fb7981ebf89a5d36b4c'
            '95cc33bf64ca54f0d15383c368cee1a4bb3dcb9ec2d68fddaa580164cef6a937'
            '522a33038ed0dc0265d9cfca96b57337a4c19d9c1e9e7131583c11a96f2308c7'
            '1a2496976d5e135681481ae2265effe54ccea9209714e5b78024803ce2f66209'
            'b0cf455e603d86ebea64818ba1e9c4be9392c06c33e6c7a8b69241256e80efad'
            '78f75255ed7d03d7434e66656942d362e12a78e42f01b8985c782c98061eb030')

build() {
  for _lang in "${_languages[@]}"; do
    _locale=${_lang%% *}
    
    mkdir -p build/$_locale
    cd build/$_locale
    cmake $srcdir/$pkgbase-$_locale-$pkgver \
      -DCMAKE_BUILD_TYPE=Release \
      -DCMAKE_INSTALL_PREFIX=/usr
    make
    cd ../..
  done
}

_package() {
  pkgdesc="$2 localization for KDE4 Applications"
  cd build/$1
  make DESTDIR="$pkgdir" install

# Fix conflicts
  rm -fr "$pkgdir"/usr/share/doc/HTML/*/{kdesu,knetattach,kcontrol/kcm_ssl,fundamentals,khelpcenter,onlinehelp}
}
