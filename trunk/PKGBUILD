# $Id$
# Maintainer: Felix Yan <felixonmars@archlinux.org>
# Contributor: Andrea Scarpino <andrea@archlinux.org>
# Contributor: Pierre Schmitz <pierre@archlinux.de>

pkgbase=kde-l10n
pkgver=16.12.1
pkgrel=1
arch=('any')
url='http://www.kde.org/'
license=('GPL')
depends=('qt5-translations') # needed for RTL languages FS#50780
makedepends=('extra-cmake-modules' 'kdoctools' 'kdelibs' 'automoc4' 'kconfig' 'ki18n' 'qt5-tools' 'python')
options=('docs')

_languages=(
  'ar     "Arabic"'
  'ast    "Asturian"'
  'bg     "Bulgarian"'
  'bs     "Bosnian"'
  'ca     "Catalan"'
  'ca@valencia     "Catalan (Valencian)"'
  'cs     "Czech"'
  'da     "Danish"'
  'de     "German"'
  'el     "Greek"'
  'en_GB  "British English"'
  'eo     "Esperanto"'
  'es     "Spanish"'
  'et     "Estonian"'
  'eu     "Basque"'
  'fa     "Farsi"'
  'fi     "Finnish"'
  'fr     "French"'
  'ga     "Irish"'
  'gl     "Galician"'
  'he     "Hebrew"'
  'hi     "Hindi"'
  'hr     "Croatian"'
  'hu     "Hungarian"'
  'ia     "Interlingua"'
  'id     "Indonesian"'
  'is     "Icelandic"'
  'it     "Italian"'
  'ja     "Japanese"'
  'kk     "Kazakh"'
  'km     "Khmer"'
  'ko     "Korean"'
  'lt     "Lithuanian"'
  'lv     "Latvian"'
  'mr     "Marathi"'
  'nb     "Norwegian Bokmal"'
  'nds    "Low Saxon"'
  'nl     "Dutch"'
  'nn     "Norwegian Nynorsk"'
  'pa     "Panjabi/Punjabi"'
  'pl     "Polish"'
  'pt     "Portuguese"'
  'pt_BR  "Brazilian Portuguese"'
  'ro     "Romanian"'
  'ru     "Russian"'
  'sk     "Slovak"'
  'sl     "Slovenian"'
  'sr     "Serbian"'
  'sv     "Swedish"'
  'tr     "Turkish"'
  'ug     "Uyghur"'
  'uk     "Ukrainian"'
  'wa     "Walloon"'
  'zh_CN  "Chinese Simplified"'
  'zh_TW  "Chinese Traditional"'
)

pkgname=()
source=()

for _lang in "${_languages[@]}"; do
  _locale=${_lang%% *}
  _pkgname=kde-l10n-${_locale,,}
  
  pkgname+=($_pkgname)
  source+=("http://download.kde.org/stable/applications/$pkgver/src/$pkgbase/$pkgbase-$_locale-$pkgver.tar.xz")
  eval "package_$_pkgname() {
    _package $_lang
  }"
done

md5sums=('f6a0e041d8242b847ae82630798b0af8'
         'fca4a30573f4fa134f5f032562ea7b33'
         '03c442267ada67baa3cfb8c75248c40c'
         '5441163c2e67e36b437424ae206492d5'
         'b2cb50df3676f9b9d31e872ae7470fe3'
         'd2ad9cc01499d2d9470159fd0cfb0a35'
         'c80acc85ed75b44fbac9556abd486c2c'
         '9f43e5db1dbb02e13ca0502fba83f2e1'
         'b0730fb6cac7528e778d9b5ca1c0b81b'
         '9d8035051a98e3d6871997c56dc75acf'
         'bcd55e759319b67c19f27b1fd9f403a3'
         '91f995fd33fc339dac268847e76f7cba'
         '387f37cb8557f5ab6ead515d8dc990c1'
         'bd705680a97ad01a8582da8fdf8035b3'
         'c997dd151f7f694bd65d49d12d1cedef'
         'ca6f0489e554d852cb0990f03419d011'
         '0cdb4dc45f2f005bca5bd45140353596'
         '4625b3264b799887effd4982f68c56d7'
         '7aa8c3597d8c1378c9da3d80e66989bf'
         'a0c64665f416f4bfa55c2987344dd714'
         '4944e64b8bf8801faaca4b0109d49831'
         '2adc40e1d6fb394c2eb4bced67caca7f'
         '18573e5ec19e3755d9b7bc76ba34e4d8'
         '95b818ac84f0580554e663891866c982'
         'bb599b17cc0389a24eb62e8c8a728c5b'
         'b97271e3c1bd1640abc747637a07bd74'
         '7893103323df9e37363f4af50c72e887'
         'd104ce35c333f593026af6cff5778e16'
         '86820648e97d70b40e7f952f17b8c5f4'
         '3dfc4cc71507f9f4da4bd2aa0a76ca24'
         'e7c1df862493c66074e5604d66e583d3'
         'a7cba663a32d97df9570a0d6d93069df'
         '21e12503e6ef3ab69921f20b2f06f229'
         '99764f81fb3302ccc395c7c99a235f0b'
         '520369d1af83d39695800c119522ff21'
         '39a4b750cb0835537d53e4b79619345e'
         '93ad9438e343daa365b20f1827a1789f'
         'a7bcb44b8200f20c841659c82b45ed29'
         '7a2d46017da522fcbaab76b261daa9df'
         '53e1d4ed59c387ad09780981791e7763'
         'c08f4b336a048eab49bc61da956d4e76'
         '67b6b4f96662dd02546f4019304d7b2e'
         '39ae893e7d3b4500fa8ff0de0f241baa'
         'b3fa16bac7897558662d61ac35cb012f'
         '987f8eba32da85b47600390287341ba9'
         'af5542c22610ad1eeca2679f0ea18665'
         'ac2b3f3ab1626aacf94f18ccbd1425e3'
         '07175659537940d98e1b92372ae8eaff'
         '78784f981d37acc4423e76e921c2c779'
         'db4f1d55254b837ba04fd41494ae0da1'
         '9b8b5f35cd23c3bd163347df8d304ec5'
         '8cce04b492ec02a80563279bbebcc2fc'
         'd4028f5c1c262afddba1e1e82fa90c0c'
         'ecad8a885cb7a2772b2b126be8b586f3'
         'eb0b44983e310b12a20f535825d335c1')

build() {
  for _lang in "${_languages[@]}"; do
    _locale=${_lang%% *}
    
    mkdir -p build/$_locale
    cd build/$_locale
    cmake $srcdir/$pkgbase-$_locale-$pkgver \
      -DCMAKE_BUILD_TYPE=Release \
      -DCMAKE_INSTALL_PREFIX=/usr
    make
    cd ../..
  done
}

_package() {
  pkgdesc="$2 localization for KDE Applications"
  cd build/$1
  make DESTDIR="$pkgdir" install

# Fix conflicts
  rm -fr "$pkgdir"/usr/share/doc/HTML/*/{kdesu,knetattach,kcontrol/kcm_ssl}
}
