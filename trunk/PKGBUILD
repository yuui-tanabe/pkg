# $Id$
# Maintainer: Felix Yan <felixonmars@archlinux.org>
# Maintainer: Antonio Rojas <arojas@archlinux.org>
# Contributor: Andrea Scarpino <andrea@archlinux.org>
# Contributor: Pierre Schmitz <pierre@archlinux.de>

pkgbase=kde-l10n
pkgver=17.04.3
pkgrel=1
arch=(any)
url='https://www.kde.org/'
license=(GPL)
makedepends=(kdelibs cmake automoc4)
options=(docs)

_languages=(
  'ar     "Arabic"'
  'ast    "Asturian"'
  'bg     "Bulgarian"'
  'bs     "Bosnian"'
  'ca     "Catalan"'
  'ca@valencia     "Catalan (Valencian)"'
  'cs     "Czech"'
  'da     "Danish"'
  'de     "German"'
  'el     "Greek"'
  'en_GB  "British English"'
  'eo     "Esperanto"'
  'es     "Spanish"'
  'et     "Estonian"'
  'eu     "Basque"'
  'fa     "Farsi"'
  'fi     "Finnish"'
  'fr     "French"'
  'ga     "Irish"'
  'gl     "Galician"'
  'he     "Hebrew"'
  'hi     "Hindi"'
  'hr     "Croatian"'
  'hu     "Hungarian"'
  'ia     "Interlingua"'
  'id     "Indonesian"'
  'is     "Icelandic"'
  'it     "Italian"'
  'ja     "Japanese"'
  'kk     "Kazakh"'
  'km     "Khmer"'
  'ko     "Korean"'
  'lt     "Lithuanian"'
  'lv     "Latvian"'
  'mr     "Marathi"'
  'nb     "Norwegian Bokmal"'
  'nds    "Low Saxon"'
  'nl     "Dutch"'
  'nn     "Norwegian Nynorsk"'
  'pa     "Panjabi/Punjabi"'
  'pl     "Polish"'
  'pt     "Portuguese"'
  'pt_BR  "Brazilian Portuguese"'
  'ro     "Romanian"'
  'ru     "Russian"'
  'sk     "Slovak"'
  'sl     "Slovenian"'
  'sr     "Serbian"'
  'sv     "Swedish"'
  'tr     "Turkish"'
  'ug     "Uyghur"'
  'uk     "Ukrainian"'
  'wa     "Walloon"'
  'zh_CN  "Chinese Simplified"'
  'zh_TW  "Chinese Traditional"'
)

pkgname=()
source=()

for _lang in "${_languages[@]}"; do
  _locale=${_lang%% *}
  _pkgname=kde-l10n-${_locale,,}
  
  pkgname+=($_pkgname)
  source+=("https://download.kde.org/stable/applications/$pkgver/src/$pkgbase/$pkgbase-$_locale-$pkgver.tar.xz")
  eval "package_$_pkgname() {
    _package $_lang
  }"
done

sha256sums=('cb47eaf9d8db2d9fbca54de5320e71f62689d4c34a8549b013b52446d2afe2fc'
            '17f94406561bc85b7ced1067d8f6d4f3e6b49a5ab804fa4d308081b1becd9a64'
            'a83232d611675fbb96e90bed2916c15c1d24e3518ad81cb7b4117febf55dce95'
            'cdc71ce2c4d15343bc85a34e81dc75b6696949687d3c5a5adf958778b87e8941'
            '39c0782162c5d9957389e62891a1183ab21b0f103ba99fefc1d2bf10a190ca40'
            'cf49647c91356eaebe89abc6f9b5caf4f4e599c3e04449a38069e168d30e74af'
            '2c28e628c64a0662124a7817f28e1f7d3ec0c5fae715fc28d2ed63b620ef3856'
            '0b2a0690fe834c9322661e11f361d25cab0764dabebc03bd23280514d34af248'
            '1e9a6c714b3898caf797ec4dcdae074fbcb497243c1ed3118fef4537558b4065'
            '993315bec3b87392c1571c09422ef3db1a9fd3073a42304e4deab6b94fcfbdd2'
            '2621f3f9b8e780165ab1da048e57ef3858295b830396e54f83d53a3afbcb29d7'
            '570d6901d426b34e0eecc7c8062a576e39a23be7855c520644f7da6a7e0005ab'
            'bc42884628c992dc0c5200dbbc84df6f7ae214ce9369b1e1cfb1d2adc23868c2'
            'b630eb1e11921356ed6e7448e09133d30d488c854b4b4c53d005a3276b3dbe31'
            '999c8750c6ef443244ea9f56492b10f84baa2dbbb20c4f991ac0618d01498219'
            '13c9f54f6d9aefed8953ea68dff5670a21d80044ebd90ce45742ccbc7d136ae0'
            '642c5cbe4da887ab3dc9eb789b93ed1fb42d7a5f711eade563e6cf585ed0df41'
            '935f9c913ff99cf2d07d435976b78110562d659535a78c605faffd86b1282792'
            '30e4d80f2a10f2464c52e497776099db462919f3a8e3bd19ae483e1d42609298'
            'c9f53a6f461ada2fb7940d79854dd21390271ddb4a978b7abf2135278af9bbb0'
            '231dc97c7c82b1a36f73fc1b940113c7ddee9bb3f4ae3c67e692100e44ba5690'
            '87eaccfaf5531f112fbb224a3501731234eddd18f5934264ffe39c33bfcb229f'
            'fbab90c0295490e890d6746e3ae12cb8572340ef88224165434214575c98ca21'
            '7fc175dd97436205a6b1613b9d5f6c1b89eb15984d7e9825943320dddb7cb444'
            'be6dd83ac49d986f27fe26a4fc6c42dd466a9206efa42f95a79ae1f7956f6fa1'
            '99ba15c31120a99a31a5a17c60b9b63b8655cd9c9aa8fc4d23f62d116ec2cc36'
            '555ba5201f2b319c17746142498b6517b514223d524b999c7046b510db4177de'
            'b396a0d2069444dd0c751ad6e22085cedc41ccae94114556a2ae26f109468658'
            'b38fc1fcbc75d7388d242055f95d27c500199defc2cf72bac08219dce4190903'
            'b4b2269f3a13bd8c66562593180cb85acd9b969ac8ef8038fe3027935e5f32eb'
            '7cdcc81ca23819e4bfe48aa3fcbf06828da3e49ff773f12838cac1e5617df1eb'
            '1b903f41f3303a37af12fec010fab054e0a7f27ba2358954d1d60e7a937b3fc9'
            'cf95cf14d186f780aa4fd013db8aac09e571f185d0aaffbb9d4389cfc451f1e6'
            '24c47e2224fee99d70d7a7a01307a829199f0f6e3202bba537ecc00b127eedee'
            '1b37ba2148230121d5d58d88b7e5a70a7d432582488c160728acdd6ee22ad7e5'
            'b9d6cd2f7e525f600b297f24b51205a524710c0c1f8bcc2e6b535dd3a37345b4'
            '039e85e9d17fbcde27f8bcf214411906b8c8ab289cb94fa8e73df5656a0e7d5f'
            'f5decc1cd331b17099a21372c5c153d230c9aa64e3dad6eacbb33640351675c7'
            '8f1ed126773521052294d0d045907f74b3c4c3c751d2d37aaac8fef3004a5d4b'
            'd592c7d6faea0f194c6167d3b86ce15248f24f6bb1fb67061ba480d5db3d2d91'
            'a5a9bf9eb48e8f0d2fd4bdedfbb1ca2796a4fa8b851bded24662185450fffd13'
            '71b9dbb8c8c1ca6bb49d0bcdaac9ac4ec24ff491e3d582ae71eadbcf64b42d01'
            '9d35b7d889a4a265463dd0c0ca4bcc28222f01af70db544862a80a346468391e'
            '32d14bf0c8fa7b2ecad52269e34181330bfceb993ffdf4f389de987276f749ff'
            'f1880e7277b54d12697cc3c6fccd9ba81b8189d011bfc6f72ea25b9ec7d14589'
            'c4270bde6be10f1563fe399b5d31967b136c0c6747dd525dbb87b6b32c497a68'
            '9557c815e36232431456ceb39365f77f469cdd51bf4687fb4fb2481b87910bd8'
            '900caf622379820fd877d9782464fb5e0054403f86e26bdee5cdfb8396ca4533'
            '763bf36527cd8708f2a3c519d7e94f781d6b0bf17e27b341d3fb239747fec805'
            'caeb895c76837af9a39b5c76649b12d814fbacf907760b61c24d2a18c6cc5d20'
            '7954dc6d2846427deb26a7da4af411a22b1d24e8353cfe3450d3f33921ab6906'
            '9fb3b155251253b9f3e394ebe84e0bcb189948b1bfae82bc159a7586f2c294db'
            '280eff23bb636a2fb479351323753ba0f1cd60e01ddcaddca0280bc5048cd48d'
            'd1cb7f5f148624d9b63f2488b55e3cefa9b37d29ed9e8967500aff8017a7ff09'
            '30f9739debf5d77f46c03c969bf77a548b5e5784892415c413241858a1e23674')

build() {
  for _lang in "${_languages[@]}"; do
    _locale=${_lang%% *}
    
    mkdir -p build/$_locale
    cd build/$_locale
    cmake $srcdir/$pkgbase-$_locale-$pkgver \
      -DCMAKE_BUILD_TYPE=Release \
      -DCMAKE_INSTALL_PREFIX=/usr
    make
    cd ../..
  done
}

_package() {
  pkgdesc="$2 localization for KDE4 Applications"
  cd build/$1
  make DESTDIR="$pkgdir" install

# Fix conflicts
  rm -fr "$pkgdir"/usr/share/doc/HTML/*/{kdesu,knetattach,kcontrol/kcm_ssl,fundamentals,khelpcenter,onlinehelp}
}
