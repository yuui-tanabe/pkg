# $Id$
# Maintainer: Felix Yan <felixonmars@archlinux.org>
# Maintainer: Antonio Rojas <arojas@archlinux.org>
# Contributor: Andrea Scarpino <andrea@archlinux.org>
# Contributor: Pierre Schmitz <pierre@archlinux.de>

pkgbase=kde-l10n
pkgver=17.08.0
pkgrel=1
arch=(any)
url='https://www.kde.org/'
license=(GPL)
makedepends=(kdelibs cmake automoc4)
options=(docs)

_languages=(
  'ar     "Arabic"'
  'ast    "Asturian"'
  'bg     "Bulgarian"'
  'bs     "Bosnian"'
  'ca     "Catalan"'
  'ca@valencia     "Catalan (Valencian)"'
  'cs     "Czech"'
  'da     "Danish"'
  'de     "German"'
  'el     "Greek"'
  'en_GB  "British English"'
  'eo     "Esperanto"'
  'es     "Spanish"'
  'et     "Estonian"'
  'eu     "Basque"'
  'fa     "Farsi"'
  'fi     "Finnish"'
  'fr     "French"'
  'ga     "Irish"'
  'gl     "Galician"'
  'he     "Hebrew"'
  'hi     "Hindi"'
  'hr     "Croatian"'
  'hu     "Hungarian"'
  'ia     "Interlingua"'
  'id     "Indonesian"'
  'is     "Icelandic"'
  'it     "Italian"'
  'ja     "Japanese"'
  'kk     "Kazakh"'
  'km     "Khmer"'
  'ko     "Korean"'
  'lt     "Lithuanian"'
  'lv     "Latvian"'
  'mr     "Marathi"'
  'nb     "Norwegian Bokmal"'
  'nds    "Low Saxon"'
  'nl     "Dutch"'
  'nn     "Norwegian Nynorsk"'
  'pa     "Panjabi/Punjabi"'
  'pl     "Polish"'
  'pt     "Portuguese"'
  'pt_BR  "Brazilian Portuguese"'
  'ro     "Romanian"'
  'ru     "Russian"'
  'sk     "Slovak"'
  'sl     "Slovenian"'
  'sr     "Serbian"'
  'sv     "Swedish"'
  'tr     "Turkish"'
  'ug     "Uyghur"'
  'uk     "Ukrainian"'
  'wa     "Walloon"'
  'zh_CN  "Chinese Simplified"'
  'zh_TW  "Chinese Traditional"'
)

pkgname=()
source=()

for _lang in "${_languages[@]}"; do
  _locale=${_lang%% *}
  _pkgname=kde-l10n-${_locale,,}
  
  pkgname+=($_pkgname)
  source+=("https://download.kde.org/stable/applications/$pkgver/src/$pkgbase/$pkgbase-$_locale-$pkgver.tar.xz")
  eval "package_$_pkgname() {
    _package $_lang
  }"
done

sha256sums=('c4c9b770754762bae6c240ba1bb3cd6d24fecc37c5202fc888f5838a18fbe04a'
            'd3adcab45d3767c022043e6c3146b72b0144cdac66702ea50565a4a1eeb0ff0e'
            '2a42df74631c3a056dcca4b4ba0ec7af9aaaa0ee4a805e8d613789e879254195'
            'b7ff17ea1edd823c4f7504caf88969c8a3d1db1a5689978d99c6ccf6c1d5399e'
            '3aff6131f798a9b089671b63e8ab083367e2989e6e1ebf94b8f3afdeb307197a'
            '0acae2db4a031a1ce1e7765e92243121c54787f4808fc4b2039f68ae9fa51a4e'
            'ec1f07099dcd051de0ccab54e142a7fc210cc62ee9317854f807b5eab5a74145'
            '3a11f27e44583bd1ebbabb5d803da444448aac6d0519f5a08a4e9aab2dfcf5bb'
            '8353c585e8439bc3704cf5ba6094642e30f6008eb1e8567d5eb72ee3c3bc5efd'
            '0f2e9456c2d4aca7df149bbdbe77bc457c12e013f6ef8cd142dae9f01f758010'
            'b8a62d7e69c2098fbb3968831006002483e7ef2d01ba8d893839373df28221f0'
            '1b45e942421b82fcb54cab05862d872b9416e06b203f740bae91572cfa270370'
            '963108ea72aca4997a216bde592d954741f48013c5a934287601f68a25964890'
            '9b2ca3ee24a39b05a51d496675d3cae49f1f5eff3675176383be3b6986311a47'
            '4b916d2d3bfa3117beaccd8881ae6b6f226b85af628b81ced66aefe8410d79f4'
            'c2737adf0476d81c23c0df02f3560a5a8c42aded330f5caf6145ddecaa5f51cd'
            'cfb67e14322d9d4a1f7dea0df23a96dc7e635f836ea619edcc882cf02e14b47a'
            '03941e4d3d1ddab3c25ec064f06fcdedfb7a7d96148b59724a0aca7051fc27e5'
            'f938d1b7b282badf9c93c21cd5264a46cb40ccc9cca30737fb359d49a4b483f8'
            'd713006df948a5d63d0da4f1e0655a24a475f474b3a46da86548dd45d0367d14'
            '9e83e6552c80e298ca8842e84ff659b1ff48a7fd7728c92d8e420aa7ce46d821'
            'cd132ecd5f90e8564016d35f02c7f55b372f083728c0cfe219a9471ef9763f7e'
            'ac2e86f281c8aef38be9bb7a7b6c8a96605be6107ab26194cfd5bfdb805fcda1'
            '81e5456bdb90ae8d5871d1490e501e41e7186b5a36a2133d828ad7b589ab98bd'
            '1a945aed0ac13682b5cb08ad54c67824360999fb7a8ed672412801ac79679286'
            '4e000be0ecb4dac093172301979e268c479318dd61083a2af41fb785e630a500'
            '2d4d4d8c912bac2b7554b1565a25fdcee93b7fcbcc5332d6ac8f9e2381927f90'
            '6bffdff741adab8ef71c365e6ed488a0de431be1307b73d1a7fab68fb809ed5e'
            '20060e6245df0ae373f979357fddb34662a94c47b88b5a68e02e8efa8a430863'
            'b5ac284eea93d6e1f2a471103366ffc8c61d5a4b6c083216573ac20dc91b2571'
            '492566cac10da150d9901f8c1b4eedb4f7473443a697ff91c98c82a6bbad15f6'
            '02f93adc864079e54fb15872e8b65e1714b1f4195a2b74fb55751a7097cbcab0'
            'bdcaa59839169e2d78088c8f76a8bd99c976ea0b2e2854c656fc4551386f9125'
            '5af6f2050938a98ff53aa0bfc6e7c33a48b6827a93d0f7a962e35245d5721a91'
            '537bdcdf80828dac63877638e35a3d5055dc971fd54231ce2cd57917545014d5'
            'f70906137f67ffd28c914acbae380193e1e37b216b5102177f0f87bcf86f278f'
            '994bb2c24eae46fb592e985af59fb586488850d980df4b60c8d79b6fa8d0b9a6'
            'a448ca585e3b78770ef01fac4658edac95006e9b175c2f27ddcb6131e59378d3'
            '477a3fda560077596617839dc9c6d095488f9c9f2eed93570623aa2c210165ee'
            '20fee9595a2242d823985b7a800dc5dce805e343503491c8cad598b6b012056e'
            'c119749868278db3bcd5e38e5bc1e19f89cbf8921766bb57f8a4b140ea96d2d5'
            '7e1b8568a48821ff363e5486f1679bd5336a07b9af1dc5d7c9494fa430a184fc'
            '400cef70d8621309647e09b7a8b1febaf841c16c5dbbc70e639aeae312e2ebc1'
            'baad20406eddacf7fd4078007f2a80acde7c5b0154b9f1bd39f44f2683ba7578'
            'c9c5c3bcac8925289045ab2d9ef5a38d4af4e435a3395c2238258a2f9335ba47'
            '01b6a4d555a00430848846171b1837b14afcfeef9b83ceab94394cb66887c03c'
            '60b5138765994172f9aee5a9951aafa5fdfd127939b9a63906cc97d5fd9e406f'
            '7c4ae1db1cf5cb45bc771206fb14b961ed03244e18383c62bf327cf63cb20173'
            '1cf81a537fa99416725a421e819855216aa14c722ef3ff4068a2ab168b690926'
            '550fc8a77f005802db8d5002fc471f4d29708575f0387ef5fec962e199a1e4b5'
            '257a865e640b0ecbd6555fd5eda8ead62367977129cc41959ac2ea880515e300'
            '9f456c245828bd3a7af3fa30f96701b32eb88f4939fac536b06cb949fcdf5982'
            '2102c530f6d46814b56b9a828d4d52f10d8520893c2a684816c7ca20542ea95c'
            'e8d585a85370d2d973bbd5e803569ef6c9f9642077982832743ffe6a9dd2dd21'
            '0e5cb56bad440c03745933be64f88504020e2d4bb2483158264b5ee134121813')

build() {
  for _lang in "${_languages[@]}"; do
    _locale=${_lang%% *}
    
    mkdir -p build/$_locale
    cd build/$_locale
    cmake $srcdir/$pkgbase-$_locale-$pkgver \
      -DCMAKE_BUILD_TYPE=Release \
      -DCMAKE_INSTALL_PREFIX=/usr
    make
    cd ../..
  done
}

_package() {
  pkgdesc="$2 localization for KDE4 Applications"
  cd build/$1
  make DESTDIR="$pkgdir" install

# Fix conflicts
  rm -fr "$pkgdir"/usr/share/doc/HTML/*/{kdesu,knetattach,kcontrol/kcm_ssl,fundamentals,khelpcenter,onlinehelp}
}
