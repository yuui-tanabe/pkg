# $Id$
# Maintainer: Felix Yan <felixonmars@archlinux.org>
# Maintainer: Antonio Rojas <arojas@archlinux.org>
# Contributor: Andrea Scarpino <andrea@archlinux.org>
# Contributor: Pierre Schmitz <pierre@archlinux.de>

pkgbase=kde-l10n
pkgver=17.04.2
pkgrel=1
arch=(any)
url='https://www.kde.org/'
license=(GPL)
makedepends=(kdelibs cmake automoc4)
options=(docs)

_languages=(
  'ar     "Arabic"'
  'ast    "Asturian"'
  'bg     "Bulgarian"'
  'bs     "Bosnian"'
  'ca     "Catalan"'
  'ca@valencia     "Catalan (Valencian)"'
  'cs     "Czech"'
  'da     "Danish"'
  'de     "German"'
  'el     "Greek"'
  'en_GB  "British English"'
  'eo     "Esperanto"'
  'es     "Spanish"'
  'et     "Estonian"'
  'eu     "Basque"'
  'fa     "Farsi"'
  'fi     "Finnish"'
  'fr     "French"'
  'ga     "Irish"'
  'gl     "Galician"'
  'he     "Hebrew"'
  'hi     "Hindi"'
  'hr     "Croatian"'
  'hu     "Hungarian"'
  'ia     "Interlingua"'
  'id     "Indonesian"'
  'is     "Icelandic"'
  'it     "Italian"'
  'ja     "Japanese"'
  'kk     "Kazakh"'
  'km     "Khmer"'
  'ko     "Korean"'
  'lt     "Lithuanian"'
  'lv     "Latvian"'
  'mr     "Marathi"'
  'nb     "Norwegian Bokmal"'
  'nds    "Low Saxon"'
  'nl     "Dutch"'
  'nn     "Norwegian Nynorsk"'
  'pa     "Panjabi/Punjabi"'
  'pl     "Polish"'
  'pt     "Portuguese"'
  'pt_BR  "Brazilian Portuguese"'
  'ro     "Romanian"'
  'ru     "Russian"'
  'sk     "Slovak"'
  'sl     "Slovenian"'
  'sr     "Serbian"'
  'sv     "Swedish"'
  'tr     "Turkish"'
  'ug     "Uyghur"'
  'uk     "Ukrainian"'
  'wa     "Walloon"'
  'zh_CN  "Chinese Simplified"'
  'zh_TW  "Chinese Traditional"'
)

pkgname=()
source=()

for _lang in "${_languages[@]}"; do
  _locale=${_lang%% *}
  _pkgname=kde-l10n-${_locale,,}
  
  pkgname+=($_pkgname)
  source+=("https://download.kde.org/stable/applications/$pkgver/src/$pkgbase/$pkgbase-$_locale-$pkgver.tar.xz")
  eval "package_$_pkgname() {
    _package $_lang
  }"
done

sha256sums=('288598dd696fed89733d98231bb08867502dce9b927b983c2a47d7bdda2ec770'
            'b3669ac185ca84bcf7516174b500c755d20b749402917c61a0f465d383d5d86c'
            'e42e8a0c03cfd8ec8eac2a5173b70adffafea41b73a044441a51fa22f66e2742'
            'c7fe28b0f1afcdc47f6a13b7af094fb92a9e939ffab42c822b673751d29b5187'
            '7b2de6d64ee6b44c6d371f4327aa6231a6d2e608bffb0f548e7addd5f1169268'
            'eeb8926e04658f7e2ade4b91ec984c8b27dc98dda6445bb549e95d2677072bb6'
            '32f78fe1e1be57bd011c7443641cce4b944061c1b484a597ea6939f5b3fb1216'
            '5039500e0071bf650e647fb62119698ed0214534d967236b3371773706dce815'
            'ab454de00536d9cea0f96801ff6a25127b458e5c749d57c847c85fd1985e38c2'
            '2c7eb339ec8fdf6f2e6b0bbf830d85fc1daaa1bc0ffa4e2cb548a6b8431ed618'
            '81589cf3b51f8c7a8480947a24ce65c14aca19645a3c9691b770ca36c2d9078c'
            '54d3623042689bd33b26caa4b6a87c6c369f502ddc59ff77502a134ddea8221a'
            '8474ff3b15c71452e23bf735dab1a2f2201b403f858a7f1f35ae38fb5f7484aa'
            'a4430084aa512f58bdca360f215672723c14078cee5dc23891f18a21759818b6'
            '8c379aa2642e430fbb648652d9293276003eeef6c76c188eb6089112344e3d4e'
            '0b84adc1391df10f27833adebfa9101a1e6ce9b506cfdabe352e1488e383c7a0'
            'eb4c5744eb8cc24f9588adf53bc97c9323210aa69a27015267bf6dfeac7a8adc'
            'd0b33962e59bb316a139ca58394f89d4910d37d5360a8e8599927d3a33307e51'
            'da879d58b79bde5ccb0317b97953ee8cc3ea09b212b787380fe669b67f8cb31b'
            '907d4b51ec605eef6813863707e6d61565315c90a40ac90734c1bd7a14d93d15'
            '45c8e9c6c40fc419657df3c7b91f560a78743b4428b5ec430d893f2b066279f0'
            '6ee1cad4fd4591669a1b35df743e516e527d6354067163331b6f963a70f7a4cd'
            '51ba38ce8ebabe8ac45e322519887898e44e28a4c9718e518e617cbf32db6ad4'
            'fa409ecdbb6b0f7bb02663c453a0e77a1b1c9f608f3ae2f82b5349e7402309ee'
            '578466632f10ea486b1b44ed7d56f8e31d18c1bc219d660d6acbc89c790e694c'
            '2c002e91c8feeea0f38a3eaed4ea9942f78920269de0d198a661ff67eff2ee8e'
            '583aba4c3efe11e14f952d7121d1c9987e9da1f9f91ee67855681023dc7f96a5'
            'd378c97e07439c8a10d5d29136a9c62c0f6a132790bf8dcf1134ab5a61deda71'
            '1ed662b8b2e220d51a81992bfac0771bcbbddb86c129c9b560b99c382f7281ac'
            '8507637a143f1cb1216d3744b89daef976de18394e524ebf6f18844db9d45906'
            'e977d2136bb1ea8fa0a145607a88a8754ad090fc3a62b93cc167d669b91286bb'
            '4abc6820346e6294f37f16d9f565d8f4282f10d7cf4e740fdcc4ce834bc6b7ac'
            'fce426abaaed2270539cb5e895c099764f05efcf8d33474de046f4767a1bf61a'
            '25947d78f8cc76d1152eab95b2a1e7fe17d5af6b4aaaa370fdd84f1c3a645328'
            'd1b6324b268039d1c5e31d289d761cd6d3a6b186ca7cf0db73ca2b82c84e4f56'
            'd1b20dae34d897cb49d0064122d3e572d684416360f58d41663ba6f1f040b82f'
            'a45fa0a9ba1d7e2025dbdef18edd8f532b5596da2f1ebf462542d63cd05ced66'
            '9dafc0661d6e6d5fc0692095ee65d0e463d5fe30bb938ce725e12a2c52d30da0'
            '032e33d63b070a78455977703d29597a4a2c9688600ce49c9e176d08b71c6bed'
            '4abb0e9eafaf796b84afaf9936a61d9e76f51c359bb423bd12fe669bd9320a6c'
            '5620be59a17f48183dfaead059c5483701ed0ebceb1efac8ce0142d9fda71f32'
            'f1fe529be3578fa7a5f5319d9bee713e0d4c8cfd22b426faa5522c776812d793'
            'd5cd69f8c0051a9983df6862c0987dbcbd5877d79fbd61807a17050edbaae189'
            '9f8dbeddf0e3366c24a03542d714c3dd4d86cb45a3b5bb9dcb1c6da1ee4817bc'
            '37ac64a70ef711e73896b80c7fa24c212630085eaa7a82055406cce253bbd5b9'
            'd1793db6ff742894477af6a7afdbfa3cc7bb9569a2b7e0877232ae737e5a057b'
            '96092431accb7546495db64f572344db4711a313fa400a1becb42b7e463e21cc'
            '3ce12b7905c0b608487f9f3d224ce27d204710b86f9acd4ac33e6eb30c460cd5'
            'e078cb566433f6f70781de5bf51044ae5362518c25545087928b72764d629ff6'
            'e88801ca617352644f71727200e17b8cc02c259d5e35588a995f3d56d0e6b5ba'
            '7099c0555f0a1db40d30b7d94cdb2ebc924ebf4a34d320ccd17bb93530066550'
            '04d67214b4c7e39c257ea78ffd0be7fb9d07538d715921068eeda3299a9dd3f6'
            '432922875b6caca1ef2ecd4bc7d428eb2c6eeed01d461065a885d13c3abc3ab9'
            'bc7ac3af47e69351bcbbb85a544970f61a3f3821aef1685d4dcabc3b7471a888'
            'afc2c61dbfcae0a9e932046679d1f501d4c44b348c1dec477f6d291f3e34e663')

build() {
  for _lang in "${_languages[@]}"; do
    _locale=${_lang%% *}
    
    mkdir -p build/$_locale
    cd build/$_locale
    cmake $srcdir/$pkgbase-$_locale-$pkgver \
      -DCMAKE_BUILD_TYPE=Release \
      -DCMAKE_INSTALL_PREFIX=/usr
    make
    cd ../..
  done
}

_package() {
  pkgdesc="$2 localization for KDE4 Applications"
  cd build/$1
  make DESTDIR="$pkgdir" install

# Fix conflicts
  rm -fr "$pkgdir"/usr/share/doc/HTML/*/{kdesu,knetattach,kcontrol/kcm_ssl,fundamentals,khelpcenter,onlinehelp}
}
