# $Id$
# Maintainer: Felix Yan <felixonmars@archlinux.org>
# Maintainer: Antonio Rojas <arojas@archlinux.org>
# Contributor: Andrea Scarpino <andrea@archlinux.org>
# Contributor: Pierre Schmitz <pierre@archlinux.de>

pkgbase=kde-l10n
pkgver=17.08.2
pkgrel=1
arch=(any)
url='https://www.kde.org/'
license=(GPL)
makedepends=(kdelibs cmake automoc4)
options=(docs)

_languages=(
  'ar     "Arabic"'
  'ast    "Asturian"'
  'bg     "Bulgarian"'
  'bs     "Bosnian"'
  'ca     "Catalan"'
  'ca@valencia     "Catalan (Valencian)"'
  'cs     "Czech"'
  'da     "Danish"'
  'de     "German"'
  'el     "Greek"'
  'en_GB  "British English"'
  'eo     "Esperanto"'
  'es     "Spanish"'
  'et     "Estonian"'
  'eu     "Basque"'
  'fa     "Farsi"'
  'fi     "Finnish"'
  'fr     "French"'
  'ga     "Irish"'
  'gl     "Galician"'
  'he     "Hebrew"'
  'hi     "Hindi"'
  'hr     "Croatian"'
  'hu     "Hungarian"'
  'ia     "Interlingua"'
  'id     "Indonesian"'
  'is     "Icelandic"'
  'it     "Italian"'
  'ja     "Japanese"'
  'kk     "Kazakh"'
  'km     "Khmer"'
  'ko     "Korean"'
  'lt     "Lithuanian"'
  'lv     "Latvian"'
  'mr     "Marathi"'
  'nb     "Norwegian Bokmal"'
  'nds    "Low Saxon"'
  'nl     "Dutch"'
  'nn     "Norwegian Nynorsk"'
  'pa     "Panjabi/Punjabi"'
  'pl     "Polish"'
  'pt     "Portuguese"'
  'pt_BR  "Brazilian Portuguese"'
  'ro     "Romanian"'
  'ru     "Russian"'
  'sk     "Slovak"'
  'sl     "Slovenian"'
  'sr     "Serbian"'
  'sv     "Swedish"'
  'tr     "Turkish"'
  'ug     "Uyghur"'
  'uk     "Ukrainian"'
  'wa     "Walloon"'
  'zh_CN  "Chinese Simplified"'
  'zh_TW  "Chinese Traditional"'
)

pkgname=()
source=()

for _lang in "${_languages[@]}"; do
  _locale=${_lang%% *}
  _pkgname=kde-l10n-${_locale,,}
  
  pkgname+=($_pkgname)
  source+=("https://download.kde.org/stable/applications/$pkgver/src/$pkgbase/$pkgbase-$_locale-$pkgver.tar.xz")
  eval "package_$_pkgname() {
    _package $_lang
  }"
done

sha256sums=('6bccb72e7f2bddfaf1a9cfae51886c60debe671d71adf3a0feb859c2b188b8d4'
            '7f632f3c8e63f7a92e96abf806adb0a8feaf436193c99eb409139016365458f8'
            '5e5d5428d360ccdec9a3fa1158d568aa777307d9162103b1e0487a1926d11440'
            'e7f9dd2430879699352d4117f305dc060a70a0cfcbc2a8493bc8c13210e250d8'
            '1fecbf9cbbe49549c8a380840dc327c5b513dfd8fe3d14812ae20e9385dee4a1'
            '56a5eae996336ee8113c85c417b5ebd3525cb51cb2248f943315cfee669bfe5c'
            'b11f713ca00c7d80152b822cde2ddcd01e7bb287841c93478945ec9e03ec1d8f'
            '590773884a788a4c42ba58d532fb079eea4ca73098b48d1d086a56a607ae0edb'
            '3ca0bda0915153f0c3e607fc2991c9cc79c57ed4d7a8ab70012fe2d4f4c71a60'
            '5dc7585a319d209646082df4a2d40294a9441d23232d159be9a3d6c21ec707bc'
            '6ec7f7fdb896633d11efa908bcb55523b3a9b43f6d045898ce25816747c1670f'
            '05a6b09b8c5b7a21a945ee7bbc587be5999c9a8eb77c8ebe514f1925576de9f0'
            '352d1ee5d606c2c9d82a0e7f0cc9c99812e30603ac5457dde7dc148a63295e48'
            '89668c60708cce45c6546c29e9d0a330beeb2422544ab76072534772641cec34'
            'b02182ebe33e1f82980de710882391cfd01507c2da74c29527372cc854288898'
            '51531272c8e0f9b07f2a2743db4622ff15d0403a4b5669a6b1d01f51d0e61c0c'
            'af68bc747819906f654ee16d2d98c2fcbc6b9d910385d56454860caf759b77e7'
            '6959749790bcbf726dcda66b18104358c21d1d30078fd8de7e8168bb5b112545'
            '0d4d31bd0601715b9a9259f3098a80eb738053583d47a9417f56629bd0a9fe28'
            'a65a22aaae17709d596a991767d028b608927f255fa85700eb2a4f3c34240ed8'
            '9db17cc77220e404d585ae94b846d75d2ce21d8a823a146787d75f2d93ae68ae'
            'd0b87469a87e7d8d5da7acfb1a6cd8a9ed63f9aea480f10a24097bdb7a92d2f1'
            'aee0785f5f019a8c2eefae29fef396a70bdbbfe227b9baa788b0dfbdef5c0c1c'
            '4e801e7a5b91d941fbe79a646295911ddb216634a8463c21111084ad02ace7bc'
            'fb22c10f98842d97ca89fe88b92e8f2fe8d7c6370a66e89c4e23ce5d512903b5'
            '365d091489bcda1f18b27dc2f1d27d29161962754adcba66ccefc72258773730'
            '93bcf935a1f5b8b1586f648a2d41189f50cf795d66ddd99942839ca17311b0c9'
            'a7b951fef9a9c98ede93e1a4f85d8d35a360b709bb0bc6aa89b68e087b91bc04'
            '207e0f2ba34a7262f3201e52c4068bfd2bd2c519d0eddc622f6c48e87ec07b6f'
            'f3fe85f2f10ad79b7eaed4da8b2b9c6f3e9f63cb6d07012545bf520b99ed7093'
            '42fdd8e17ee3ca7f53a62b0d34fdaef62d5ecc1a2b0f4194d35fa732fc5e0261'
            '62ee377cb926f6084cbd473aa71b51b8b61b7e3e3f913cac10e0d71334978bec'
            'c52682068c05e03d98a40a63852d2648228c20f93b15edc022b879f8d49c0938'
            'bc79f62a9d4d75a655893e8fc809697c12f42902a4bac9d733227803dba5882b'
            '8c587e9bcfe0883ab6570312f42440c3c71e830ed4539bc100a1edea4806c780'
            '9317b4d14948d8f2b30694bd0a5ac505333a86bc30c22d7c39e15336a6655231'
            '2349bb38e7058670bc6e205f24503e3df000ee30c9cd23c4c2937b8d08bbbf64'
            'a7c1a2c57405750f37d8890cf9acb5677e715d71476dcc6b5c9a29dd81091f0a'
            '0d68e5e97693f8f34605c97820b4647fa1c18aa7dd9a9263eedfad51723aa700'
            'eef4740dadc484f2b8649e4489065a7c3b6d9046c69b09172ca31afd7df7e510'
            '3092816df9e3db7b7a6f8fa9a98b9e2e2a1b88b37ed38fe6d5e15e265412678f'
            '90315212e6e161c21293863c32bf66e40b4bfde3d4e0f7f049e1fb742f54678f'
            'b022d939104668014adb00682d77d4f93777220039f9c717814b42932a3b0da7'
            'f0c0978bb3a71110e15d3196900f6e71ce7c6e156bba39e1c970633d77935e96'
            'cec7224706ce09ec3ed5cad16625b56efb136112627f427b2c68af00232765ee'
            'b3502dd85fcc086c12ea74237c085ab3f7d071a97a56e1bd1459c09f2e1b9258'
            '81d24c8d7deaa14bf990f710056e73fe954a60fa6d6054669b93b2c67075b715'
            '849eb132b81782d5570521b8434f1488907332ccfca88ed67be955efb2f95bf9'
            '5e5f23928f92078862e2ead5def08c4c67d014ea06131dc285eb8f943da6f6c3'
            'b48f5a8b74fd6f1bf699e3bc8a74be8f814ae70af7ac2b24e710ffecf438b1d6'
            'b803eec6f0ef7d5dd73c5a5264201a5e249a0b18b46b82c2d9d078042efb982c'
            '0c18c9c3ecc4cab0bb6d0da19be344f90f6cc1e52e7b03d7aa0de8620e9b79cb'
            '503ffcc609628f2a29962cf41b7c5301ae61ef8aea4e7c97a970af4b5251ccca'
            '00520157ccf06cc05208a388eeb129d9d0d1cfcf0c99a4aa5d4e69591ae4fceb'
            'bc0ad8f799ab98a5aaaf34940fb2cf41c62ba9c103f7256b4246003a0ca498ec')

build() {
  for _lang in "${_languages[@]}"; do
    _locale=${_lang%% *}
    
    mkdir -p build/$_locale
    cd build/$_locale
    cmake $srcdir/$pkgbase-$_locale-$pkgver \
      -DCMAKE_BUILD_TYPE=Release \
      -DCMAKE_INSTALL_PREFIX=/usr
    make
    cd ../..
  done
}

_package() {
  pkgdesc="$2 localization for KDE4 Applications"
  cd build/$1
  make DESTDIR="$pkgdir" install

# Fix conflicts
  rm -fr "$pkgdir"/usr/share/doc/HTML/*/{kdesu,knetattach,kcontrol,fundamentals,khelpcenter,onlinehelp}
  rm -fr "$pkgdir"/usr/share/man/*/man1/kdesu.1
}
