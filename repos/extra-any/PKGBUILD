# $Id$
# Maintainer: Felix Yan <felixonmars@archlinux.org>
# Contributor: Andrea Scarpino <andrea@archlinux.org>
# Contributor: Pierre Schmitz <pierre@archlinux.de>

pkgbase=kde-l10n
pkgver=16.12.3
pkgrel=1
arch=('any')
url='https://www.kde.org/'
license=('GPL')
depends=('qt5-translations') # needed for RTL languages FS#50780
makedepends=('extra-cmake-modules' 'kdoctools' 'kdelibs' 'automoc4' 'kconfig' 'ki18n' 'qt5-tools' 'python')
options=('docs')

_languages=(
  'ar     "Arabic"'
  'ast    "Asturian"'
  'bg     "Bulgarian"'
  'bs     "Bosnian"'
  'ca     "Catalan"'
  'ca@valencia     "Catalan (Valencian)"'
  'cs     "Czech"'
  'da     "Danish"'
  'de     "German"'
  'el     "Greek"'
  'en_GB  "British English"'
  'eo     "Esperanto"'
  'es     "Spanish"'
  'et     "Estonian"'
  'eu     "Basque"'
  'fa     "Farsi"'
  'fi     "Finnish"'
  'fr     "French"'
  'ga     "Irish"'
  'gl     "Galician"'
  'he     "Hebrew"'
  'hi     "Hindi"'
  'hr     "Croatian"'
  'hu     "Hungarian"'
  'ia     "Interlingua"'
  'id     "Indonesian"'
  'is     "Icelandic"'
  'it     "Italian"'
  'ja     "Japanese"'
  'kk     "Kazakh"'
  'km     "Khmer"'
  'ko     "Korean"'
  'lt     "Lithuanian"'
  'lv     "Latvian"'
  'mr     "Marathi"'
  'nb     "Norwegian Bokmal"'
  'nds    "Low Saxon"'
  'nl     "Dutch"'
  'nn     "Norwegian Nynorsk"'
  'pa     "Panjabi/Punjabi"'
  'pl     "Polish"'
  'pt     "Portuguese"'
  'pt_BR  "Brazilian Portuguese"'
  'ro     "Romanian"'
  'ru     "Russian"'
  'sk     "Slovak"'
  'sl     "Slovenian"'
  'sr     "Serbian"'
  'sv     "Swedish"'
  'tr     "Turkish"'
  'ug     "Uyghur"'
  'uk     "Ukrainian"'
  'wa     "Walloon"'
  'zh_CN  "Chinese Simplified"'
  'zh_TW  "Chinese Traditional"'
)

pkgname=()
source=()

for _lang in "${_languages[@]}"; do
  _locale=${_lang%% *}
  _pkgname=kde-l10n-${_locale,,}
  
  pkgname+=($_pkgname)
  source+=("https://download.kde.org/stable/applications/$pkgver/src/$pkgbase/$pkgbase-$_locale-$pkgver.tar.xz")
  eval "package_$_pkgname() {
    _package $_lang
  }"
done

sha256sums=('a3042d3598f77bca795ed97f4cae6c65cd7c737ba7ca58cf0e8a28807fb2d1a8'
            '23ac9748cb24e663cf8a018eb58a552d801b3fa25e3ff329a82a6e545727b115'
            '62c869067af2b2cde4190d2b7e97225c3442980c0073bab1d2f78b9841f998b2'
            'bbc9dee9bd6dc86ea9596ea347ad0a7af9f62f8a0ac95a3702b0aa1e29c1d7d1'
            'ba6ed776cdfc66a9d8772c079ec2210e2e328ba4e987e91fb138f678db3b6dc0'
            'c052abfc0664aae0e41152eb1d7be225e3173dc96cfaac011a9812648908e101'
            '21b96e7c9a816026fd8b8bd8e8df79d4a847b7c48ef9f7c6c981dff01605745b'
            'f8e285123ccc1d2e6eea9ca9217e66499bf8951af5ab37a5b00fbb82c1075baf'
            '660a98fe83ad38299a401fe588079fe050b29d54a2d30e66e36b67836c70a67a'
            'cce01a5675ba3554e7526277e1760221de25562c28fd28f2f0096751e00ca5b5'
            '36246656f1f39b8815a27b3a0a6368498ff0bff89cf717f6138480a9ca748679'
            '019090012b6f9505bf098b5a59d160e7bcedd28834955948205de8a455b8835c'
            'e19262d0fe74408cd01826a611dea8f9df2370b059734fbc8c8bc5aec2dc9aa4'
            'f3927454e0abe398d448d10df9c4da8fefc2b7d1fb433a598425cb130acb15e0'
            '086413b4752731a685bdfc6d63a39b226de047a90dcdde406d7a726e3d9dfc35'
            'ab556e97029d8b3605bd6fccacc95a0afe48ae824e9f3aee556dec261ebe91fb'
            '496c888bda5924e3f743cebd436f58e156dcd116e700e908aee060a6369df985'
            '9571a472e3e0dc9742f3ec224f02a54a0051ab7d95999ebb3da9844b6322a863'
            '356805aa99c9dbd37b3c587e6bf7b93125f8ab0cbd90e89f011af7455015891b'
            '7b0e7b7c48f600039005b396763ef9b27d3342831859dc6b9caed7856bf3d2cc'
            'dea897d5d7b716f69ff7a3f43adf3aaa8295f5c2395c0148bcbc976753e3c1e7'
            '93b7fe41135eb5e4c0b7a6332c8658995db376cfd80a664b5883a188b38a92e3'
            'e1761f78cd1170f53e84309bf652a0940060b29a904fa7a15219ce1b7cdb7778'
            'fff2a46b41efa353f1d7c82341d617735a4eb64c5b3ac38e148e480628a03700'
            'd964627f9922829f0b718a19aa27f8a48d27cc6a20bc26196726e7f8bbc9e926'
            '2a9b842eb7d6b68a3c95221a0a56aa20d9bca9287b372823564ad20048a656cd'
            'db8c2375a253dff7389467c4aa4017e275222f77372d023c4faba76d65d74981'
            '3eaba4b8f268aaa8ba8f8f0937a44f9b3fe3e34c61bedef86b86ff11e90ce738'
            'db9b58e260d1d89bc205ee04f291c792a8c4c8105cae36697b644440c6ce0adc'
            '252692409bc4ea40abf90d937898cea7d28245f8530911d1127576f8d95263c6'
            '3a77d568337a8126fe7e95021995f65686652d66e8d4dc6faad3c483f67497d3'
            '9e2c133ac00350000a7e35e888df26ae44023c884517e0b490ddf767f39d1030'
            'e7fca79f111b30e3bdafef263df035e02026a3edd941d6efedff2e1db1a0a211'
            '226045b4888f41f2daa31fced167c8fab5a3fe710f8c4d396ca39398cf1dc1a9'
            '5d4d4cea3c883934a3f607ea6d5ad3b7ad7364dc9bffc7896a17a71e82a5e899'
            'aeb131d96fd39ff06113f0c240c66d67de0d5ceb094920845f88af683eaa3c24'
            '8cedbdf2df869b23183a2eab781ee3ce76c563b095b31ea703788f968be05614'
            'f1ef286e2b270dd0d2c9140c366b1813d1a3ff810b3bcd185d820470b0bcb42b'
            '286c00f3ef64dbe8dc562a3bb26da2b79ed5336154ea27a46a9bcf43e4be8862'
            '9559b4a1593ecab3c38f140f6ec05696f1c63bf2e18964a4470aeeb9cab25a64'
            '05f38dd9f147d8678b904cbe2c4c898207b27521f943423bedc33a7e465ee8ae'
            '0662e6079ef25b62cd05372260e2c76179be37920b4820b2277ce0848c5779b8'
            'da18e9e28e77a14c5dfd2eb5c56c588599d9fdf07d35c7e6d979214bca6d001a'
            'b07338da9824145e5fe1a10784def208e0dd1a5555d0396e5a1f39090a9c6b9e'
            'ea67d4fa07bd640146f3f89ae6a155bba6766c87bb72141fadd644823c7ff089'
            '967dfb2a4e7adde5ab888d43abcd86f262b5bb4c7626d06be282eb6b45658141'
            '80ab818a8a69fdd5ad45d7db7f6fdb3f5e7cddb04590d72d3799ee0bc873a009'
            '9f210339268020a049afb695ca5286178c2869414de50f82259f49357d2304fb'
            '2bd3f69e87061dda4764496b7af6f1ce263d581a014585228c597269927e0ae1'
            '16c427d059d34f38860803a6161d5dc1cb6d4b22a27cc741558b42b8146844d0'
            'd60244a5b0e55ab95947cd4e75868a02edcb4fdaf831b85d78e979c9cd086469'
            'bf2ef1ce317c2a3599c54aa9275e30e0c1f964cc046eb057687cc5bbfac6771c'
            '2ed713d8b79c82783d2a8573ee7a2cd34963938b4cc3aa3271f0fc4b92d01593'
            '81bc711d17fa744ddf40057884793548f742df8d3ad8fd9f6857f211d8130907'
            '70bc617608417a7c6bed2eb580b11f198d5b14470c1e19c34c8694bc68b73d29')

build() {
  for _lang in "${_languages[@]}"; do
    _locale=${_lang%% *}
    
    mkdir -p build/$_locale
    cd build/$_locale
    cmake $srcdir/$pkgbase-$_locale-$pkgver \
      -DCMAKE_BUILD_TYPE=Release \
      -DCMAKE_INSTALL_PREFIX=/usr
    make
    cd ../..
  done
}

_package() {
  pkgdesc="$2 localization for KDE Applications"
  cd build/$1
  make DESTDIR="$pkgdir" install

# Fix conflicts
  rm -fr "$pkgdir"/usr/share/doc/HTML/*/{kdesu,knetattach,kcontrol/kcm_ssl}
}
